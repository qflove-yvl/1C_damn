<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ó–∞—è–≤–∫–∏</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-950 text-slate-200 min-h-screen">
<div class="max-w-6xl mx-auto px-6 py-10">

    <div class="flex justify-between items-center mb-10">
        <h1 class="text-4xl font-semibold">–ó–∞—è–≤–∫–∏</h1>

        <select id="filter"
                class="bg-slate-900 border border-slate-700 rounded-xl px-4 py-2">
            <option value="">–í—Å–µ</option>
            <option value="–ù–æ–≤—ã–π">–ù–æ–≤—ã–µ</option>
            <option value="–í —Ä–∞–±–æ—Ç–µ">–í —Ä–∞–±–æ—Ç–µ</option>
        </select>
    </div>

    <div id="orders" class="grid gap-6">
        {% for o in orders %}
        <div class="bg-slate-900 rounded-2xl p-6 shadow-xl transition hover:scale-[1.01]">
            <div class="flex justify-between items-start">
                <div>
                    <h3 class="text-xl font-medium">
                        –ó–∞—è–≤–∫–∞ ‚Ññ{{ o.id }}
                    </h3>

                    <p class="text-slate-400 mt-1">
                        {{ o.client_name }} (@{{ o.client_username }})
                    </p>

                    <p class="mt-4 whitespace-pre-line">
                        {{ o.text }}
                    </p>

                    <p class="text-sm text-slate-500 mt-4">
                        üìÖ {{ o.created_at.strftime("%d.%m.%Y %H:%M") }}
                    </p>
                </div>

                <span class="px-3 py-1 rounded-full text-sm
                    {% if o.status == '–ù–æ–≤—ã–π' %}
                        bg-blue-600
                    {% elif o.status == '–í —Ä–∞–±–æ—Ç–µ' %}
                        bg-yellow-500
                    {% endif %}
                ">
                    {{ o.status }}
                </span>
            </div>

            <div class="mt-6 flex gap-3">
                <button onclick="setStatus({{ o.id }}, '–í —Ä–∞–±–æ—Ç–µ')"
                        class="bg-yellow-500 text-black px-4 py-2 rounded-xl">
                    –í —Ä–∞–±–æ—Ç—É
                </button>

                <button onclick="setStatus({{ o.id }}, '–ì–æ—Ç–æ–≤–æ')"
                        class="bg-green-600 px-4 py-2 rounded-xl">
                    –ì–æ—Ç–æ–≤–æ
                </button>

                <button onclick="setStatus({{ o.id }}, '–û—Ç–∫–∞–∑')"
                        class="bg-red-600 px-4 py-2 rounded-xl">
                    –û—Ç–∫–∞–∑
                </button>
            </div>
        </div>
        {% endfor %}
    </div>

</div>

<script>
function setStatus(id, status) {
    fetch('/status', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({id, status})
    }).then(() => location.reload())
}

document.getElementById('filter').onchange = function () {
    const v = this.value
    window.location = v ? `/panel/orders?status=${v}` : '/panel/orders'
}
</script>

</body>
</html>
